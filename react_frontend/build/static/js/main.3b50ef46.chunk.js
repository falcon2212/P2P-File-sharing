(this.webpackJsonpreact_frontend=this.webpackJsonpreact_frontend||[]).push([[0],{101:function(e,t,n){},128:function(e,t){},132:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),i=n(21),r=n.n(i),o=n(33),c=n(8),l=n(9),d=n(42),h=n(11),u=n(10),j=n(7),b=(n(27),n(140)),f=n(142),m=n(83),p=n(139),O=n(17),v=(n(97),n(1)),x=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return this.props.login_data.logged_in?Object(v.jsxs)(b.a,{bg:"dark",variant:"dark",expand:"lg",sticky:"top",children:[Object(v.jsx)(O.LinkContainer,{to:"/",children:Object(v.jsx)(b.a.Brand,{children:"WinDrop"})}),Object(v.jsx)(b.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(v.jsxs)(b.a.Collapse,{id:"basic-navbar-nav",children:[Object(v.jsxs)(f.a,{defaultActiveKey:"home",className:"mr-auto",children:[Object(v.jsx)(O.LinkContainer,{to:"/",children:Object(v.jsx)(f.a.Link,{eventKey:"home",href:"/",children:"Home"})}),Object(v.jsx)(O.LinkContainer,{to:"/faq",children:Object(v.jsx)(f.a.Link,{eventKey:"faq",href:"/faq",children:"FAQs"})}),Object(v.jsx)(O.LinkContainer,{to:"/about",children:Object(v.jsx)(f.a.Link,{eventKey:"about",children:"About"})})]}),Object(v.jsx)(f.a,{fill:!0,className:"justify-content-end",children:Object(v.jsxs)(p.a,{eventKey:1,id:"basic-nav-dropdown",drop:"down",title:this.props.login_data.login_credentials.username,children:[Object(v.jsx)(p.a.Item,{eventKey:1.1,href:"#profile",children:"Profile"}),Object(v.jsx)(p.a.Item,{eventKey:1.2,href:"/",onClick:function(){return e.props.onReq("false",null)},children:"Logout"})]})})]})]}):Object(v.jsxs)(b.a,{bg:"dark",variant:"dark",expand:"lg",sticky:"top",children:[Object(v.jsx)(O.LinkContainer,{to:"/",children:Object(v.jsx)(b.a.Brand,{children:"WinDrop"})}),Object(v.jsx)(b.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(v.jsxs)(b.a.Collapse,{id:"basic-navbar-nav",children:[Object(v.jsxs)(f.a,{className:"mr-auto",children:[Object(v.jsx)(O.LinkContainer,{to:"/",children:Object(v.jsx)(f.a.Link,{eventKey:"home",href:"/",children:"Home"})}),Object(v.jsx)(O.LinkContainer,{to:"/faq",children:Object(v.jsx)(f.a.Link,{eventKey:"faq",href:"/faq",children:"FAQs"})}),Object(v.jsx)(O.LinkContainer,{to:"/about",children:Object(v.jsx)(f.a.Link,{eventKey:"about",children:"About"})})]}),Object(v.jsxs)(f.a,{fill:!0,className:"justify-content-end",children:[Object(v.jsx)(O.LinkContainer,{to:"/login",children:Object(v.jsx)(m.a,{variant:"outline-primary",children:"Login"})}),Object(v.jsx)(O.LinkContainer,{to:"/sign_up",children:Object(v.jsx)(m.a,{variant:"primary",children:"Sign-up"})})]})]})]})}}]),n}(a.Component),g=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(v.jsx)("div",{children:"Home of Windrop"})}}]),n}(a.Component),y=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(v.jsx)("div",{children:"About of Windrop"})}}]),n}(a.Component),k=(n(67),function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(v.jsx)("div",{children:"FAQ for Windrop"})}}]),n}(a.Component)),C=n(49),L=(n(101),n(141)),w=n(55).BACKEND_ENDPOINT,S=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={isLoaded:!1,error:null,username:"",password:"",name:""},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch(w+"start").then((function(e){return e.json()})).then((function(t){e.setState({isLoaded:!0})})).catch((function(t){e.setState({isLoaded:!0,error:t}),console.log(t)}))}},{key:"handleSubmit",value:function(){var e=this;fetch(w+"users/find",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.state.username,password:this.state.password})}).then((function(e){return e.json()})).then((function(t){null===t?(console.log("Username password do not match"),alert("username password do not match")):""!==t.name&&(console.log(t),e.props.onReq(!0,{username:e.state.username,name:t.name}),e.setState({name:t.name}))})).catch((function(e){console.log(e)}))}},{key:"handleChange",value:function(e){var t=e.target.name,n=e.target.value;this.setState(Object(C.a)({},t,n))}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoaded,a=t.error,s=(t.username,t.password,t.name);return a?Object(v.jsxs)("div",{children:["Error: ",a.message]}):n?""!==s?Object(v.jsx)(j.c,{to:"/dashboard"}):Object(v.jsxs)(L.a,{className:"form-global",children:[Object(v.jsx)("h3",{children:"Login"}),Object(v.jsxs)(L.a.Group,{controlId:"formBasicEmail",children:[Object(v.jsx)(L.a.Label,{children:"Username"}),Object(v.jsx)(L.a.Control,{type:"text",name:"username",onChange:this.handleChange.bind(this)})]}),Object(v.jsxs)(L.a.Group,{controlId:"formBasicPassword",children:[Object(v.jsx)(L.a.Label,{children:"Password"}),Object(v.jsx)(L.a.Control,{type:"password",name:"password",onChange:this.handleChange.bind(this)})]}),Object(v.jsx)(L.a.Group,{controlId:"formBasicCheckbox",children:Object(v.jsx)(L.a.Check,{type:"checkbox",label:"Remember me"})}),Object(v.jsx)(m.a,{variant:"primary",onClick:function(){return e.handleSubmit()},children:"Submit"})]}):Object(v.jsx)("div",{children:"Loading..."})}}]),n}(a.Component),_=n(138),R=n(85),q=n(55).BACKEND_ENDPOINT,I=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={isLoaded:!1,isSubmitted:!1,error:null,username:"",password:"",name:"",email:""},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch(q+"start").then((function(e){return e.json()})).then((function(t){e.setState({isLoaded:!0})})).catch((function(t){e.setState({isLoaded:!0,error:t}),console.log(t)}))}},{key:"handleSubmit",value:function(){var e=this;fetch(q+"users/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.state.username,password:this.state.password,email:this.state.email,name:this.state.name})}).then((function(e){return e.json()})).then((function(t){null===t?(console.log("Username password do not match"),alert("username password do not match")):(console.log(t),e.props.onReq(!0,{username:e.state.username,name:e.state.name}),e.setState({isSubmitted:!0}))})).catch((function(e){console.log(e)}))}},{key:"handleChange",value:function(e){var t=e.target.name,n=e.target.value;this.setState(Object(C.a)({},t,n))}},{key:"render",value:function(){var e=this,t=this.state,n=t.isLoaded,a=t.isSubmitted,s=t.error;t.username,t.password,t.email;return s?Object(v.jsxs)("div",{children:["Error: ",s.message]}):n?a?Object(v.jsx)(j.c,{to:"/dashboard"}):Object(v.jsx)(_.a,{className:"justify-content-center mb-5 mt-5",children:Object(v.jsxs)(L.a,{onSubmit:function(){return e.handleSubmit()},children:[Object(v.jsxs)(L.a.Group,{children:[Object(v.jsx)(L.a.Label,{children:"Username"}),Object(v.jsx)(L.a.Control,{name:"username",placeholder:"For eg, brain_freeze, v-house",onChange:this.handleChange.bind(this)})]}),Object(v.jsxs)(L.a.Row,{children:[Object(v.jsxs)(L.a.Group,{as:R.a,controlId:"formGridEmail",children:[Object(v.jsx)(L.a.Label,{children:"Email"}),Object(v.jsx)(L.a.Control,{name:"email",type:"email",placeholder:"Enter email",onChange:this.handleChange.bind(this)})]}),Object(v.jsxs)(L.a.Group,{as:R.a,controlId:"formGridPassword",children:[Object(v.jsx)(L.a.Label,{children:"Password"}),Object(v.jsx)(L.a.Control,{name:"password",type:"password",placeholder:"Password",onChange:this.handleChange.bind(this)})]})]}),Object(v.jsxs)(L.a.Group,{controlId:"formGridFirstName",children:[Object(v.jsx)(L.a.Label,{children:"First name"}),Object(v.jsx)(L.a.Control,{name:"name",onChange:this.handleChange.bind(this)})]}),Object(v.jsxs)(L.a.Group,{controlId:"formGridSecondName",children:[Object(v.jsx)(L.a.Label,{children:"Second name"}),Object(v.jsx)(L.a.Control,{})]}),Object(v.jsx)(m.a,{variant:"primary",onClick:function(){return e.handleSubmit()},children:"Submit"})]})}):Object(v.jsx)("div",{children:"Loading..."})}}]),n}(a.Component),D=n(26),N=n.n(D),E=n(52),A=n(86),B=n.n(A),M=n(143),P=n(87),T=n(131),U=T.arrayBufferWithMime,K=T.arrayBufferMimeDecouple,F=n(80),G=n(55).BACKEND_ENDPOINT,W=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).tmp=function(e){},a.state={configuration:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},room:null,chunks:[],clientList:[],isInitiator:null,clientId:null,dest_id:null,dataChannel:null,connections:{},datachannels:{},online:null,memberList:[],file:null,socket:null,downloadList:null,usernames:{}},a}return Object(l.a)(n,[{key:"renderClients",value:function(){var e=0===this.state.clientList.length?0:this.state.clientList.length-1;this.setState({online:e});var t=[];if(1!==this.state.clientList.length)for(var n=0;n<this.state.clientList.length;n++){var a=this.state.clientList[n];a!==this.state.clientId&&(t.push(a),this.setState({memberList:t}))}else this.setState({memberList:t})}},{key:"allConnect",value:function(){this.setState({connections:{}}),this.setState({datachannels:{}});for(var e=0;e<this.state.clientList.length;e++){var t=this.state.clientList[e];t!==this.state.clientId&&this.sendConnect(t)}}},{key:"sendConnect",value:function(){var e=Object(E.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({dest_id:t}),this.setState({isInitiator:!0}),this.state.socket.emit("sendConnect",this.state.dest_id,this.state.clientId,this.state.room,this.props.login_data.login_credentials.username),e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"t",value:function(){console.log(Date.now())}},{key:"createPeer",value:function(e){var t=this,n=this.state.connections,a=this.state.datachannels;n[e]=new RTCPeerConnection(this.state.configuration),n[e].onicecandidate=function(n){n.candidate&&t.sendMessage({type:"candidate",label:n.candidate.sdpMLineIndex,id:n.candidate.sdpMid,candidate:n.candidate.candidate},e)},this.setState({connections:n}),this.state.isInitiator?(a[e]=this.state.connections[e].createDataChannel("files"),a[e].binaryType="arraybuffer",this.setState({datachannels:a}),this.onDataChannelCreated(e),this.state.connections[e].createOffer().then((function(n){return t.state.connections[e].setLocalDescription(n)})).then((function(){t.sendMessage(t.state.connections[e].localDescription,e)})).catch(this.logError)):(n[e].ondatachannel=function(n){a[e]=n.channel,a[e].binaryType="arraybuffer",t.setState({datachannels:a}),t.onDataChannelCreated(e)},this.setState({connections:n}))}},{key:"sendMessage",value:function(e,t){this.state.socket.emit("message",e,t,this.state.clientId)}},{key:"onDataChannelCreated",value:function(e){var t=this,n=this.state.datachannels;n[e].onopen=function(){},n[e].onclose=function(){},n[e].onmessage=function(){var e=Object(E.a)(N.a.mark((function e(n){var a,s,i,r,o,c,l;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.data;try{"EOF"!==a?((s=t.state.chunks).push(a),t.setState({chunks:s})):(i=t.state.chunks.reduce((function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n}),new Uint8Array),r=K(i),o=r.mime,c=r.arrayBuffer,l=new Blob([c],{type:o}),t.render1(l,"download"))}catch(d){}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setState({datachannels:n})}},{key:"logError",value:function(e){e&&("string"===typeof e?console.warn(e):console.warn(e.toString(),e))}},{key:"render1",value:function(e,t){var n,a=window.URL.createObjectURL(e);n=a?Object(v.jsx)("li",{children:Object(v.jsx)("small",{children:Object(v.jsx)("a",{href:a,download:t,children:"Incoming file"})})}):Object(v.jsx)("li",{children:"No files available here"}),this.setState({downloadList:n}),this.setState({chunks:[]})}},{key:"signalingMessageCallback",value:function(e,t){var n=this;"offer"===e.type?(this.state.connections[t].setRemoteDescription(new RTCSessionDescription(e),(function(){}),this.logError),this.state.connections[t].createAnswer().then((function(e){n.onLocalSessionCreated(e,t)})).catch(this.logError)):"answer"===e.type?this.state.connections[t].setRemoteDescription(new RTCSessionDescription(e),(function(){}),this.logError):"candidate"===e.type&&this.state.connections[t].addIceCandidate(new RTCIceCandidate({candidate:e.candidate,sdpMLineIndex:e.label,sdpMid:e.id}))}},{key:"onLocalSessionCreated",value:function(e,t){var n=this;this.state.connections[t].setLocalDescription(e).then((function(){n.sendMessage(n.state.connections[t].localDescription,t)})).catch(this.logError)}},{key:"sendFile",value:function(){var e=Object(E.a)(N.a.mark((function e(t){var n,a,s,i,r,o,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.value,!(a=this.state.file)){e.next=11;break}return e.next=5,a.arrayBuffer();case 5:for(s=e.sent,i=a.type,r=U(s,i),o=this.state.datachannels[n],c=0;c<r.byteLength;c+=65535)o.send(r.slice(c,c+65535));o.send("EOF");case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"arrayBufferWithMime",value:function(e,t){var n=t.length,a=new Uint8Array(n+1);a[0]=n;for(var s=0;s<n;s++){var i=t[s].charCodeAt(0);a[s+1]=i}return F(a,e)}},{key:"arrayBufferMimeDecouple",value:function(e){for(var t=new Uint8Array(e),n="",a=t[0],s=0;s<a;s++){var i=t[s+1];n+=String.fromCharCode(i)}return{mime:n,arrayBuffer:t.slice(a+1).buffer}}},{key:"componentDidMount",value:function(){var e=this;this.state.room||(this.state.room=window.location.hash="1"),this.state.socket=B.a.connect(G,{reconnect:!0}),this.state.socket.emit("create or join",this.state.room),this.state.socket.on("Display clients",(function(t,n){e.setState({clientList:t}),e.renderClients(),n&&e.allConnect()})),this.state.socket.on("ready",(function(t,n){var a=e.state.usernames;a[t]=n,e.setState({usernames:a}),e.t(),e.createPeer(t),e.t()})),this.state.socket.on("reset",(function(){window.location.reload()})),this.state.socket.on("sendConnect",(function(t,n){var a=e.state.usernames;return a[t]=n,e.setState({usernames:a}),e.setState({dest_id:t}),e.setState({isInitiator:!1}),e.t(),e.createPeer(e.state.dest_id),e.t(),e.state.socket.emit("ready",e.state.dest_id,e.state.clientId,e.props.login_data.login_credentials.username),!0})),this.state.socket.on("socketid",(function(t){e.setState({clientId:t})})),this.state.socket.on("log",(function(e){})),this.state.socket.on("message",(function(t,n){e.signalingMessageCallback(t,n)}))}},{key:"addFile",value:function(e){this.setState({file:e.target.files[0]})}},{key:"createUserList",value:function(){for(var e=this,t=[],n=0;n<this.state.memberList.length;n++)t.push(Object(v.jsxs)(M.a.Item,{children:[this.state.usernames[this.state.memberList[n]],Object(v.jsx)(m.a,{value:this.state.memberList[n],onClick:function(t){return e.sendFile(t)},children:"Send file"})]}));return t}},{key:"render",value:function(){var e=this,t=this.createUserList();return Object(v.jsxs)(_.a,{className:"justify-content-center mb-5 mt-5",children:[Object(v.jsxs)("div",{children:["Users online: ",this.state.online]}),Object(v.jsxs)("div",{children:[Object(v.jsx)(P.a,{onChange:function(t){e.addFile(t)},type:"file","data-browse":"Select file"}),Object(v.jsx)("ul",{id:"downloadList",children:this.state.downloadList})]}),Object(v.jsx)(M.a,{children:t})]})}}]),n}(a.Component),J=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e;return"home"===this.props.middle_content?e=Object(v.jsx)(g,{}):"about"===this.props.middle_content?e=Object(v.jsx)(y,{}):"faq"===this.props.middle_content?e=Object(v.jsx)(k,{}):"login"===this.props.middle_content?e=Object(v.jsx)(S,{onReq:this.props.onReq}):"sign_up"===this.props.middle_content?e=Object(v.jsx)(I,{onReq:this.props.onReq}):"dashboard"===this.props.middle_content&&(e=Object(v.jsx)(W,{login_data:this.props.login_data})),e}}]),n}(a.Component),H=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={logged_in:!1,login_credentials:{}},a.handleReq=a.handleReq.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"handleReq",value:function(e,t){this.setState({logged_in:e,login_credentials:t})}},{key:"render",value:function(){var e=this;return Object(v.jsx)("div",{children:Object(v.jsxs)(j.g,{children:[Object(v.jsxs)(j.d,{exact:!0,path:"/",children:[Object(v.jsx)(x,{login_data:this.state,onReq:function(t,n){return e.handleReq(t,n)}}),Object(v.jsx)(J,{middle_content:"home"})]}),Object(v.jsxs)(j.d,{path:"/about",children:[Object(v.jsx)(x,{login_data:this.state,onReq:function(t,n){return e.handleReq(t,n)}}),Object(v.jsx)(J,{middle_content:"about"})]}),Object(v.jsxs)(j.d,{path:"/faq",children:[Object(v.jsx)(x,{login_data:this.state,onReq:function(t,n){return e.handleReq(t,n)}}),Object(v.jsx)(J,{middle_content:"faq"})]}),Object(v.jsxs)(j.d,{path:"/login",children:[Object(v.jsx)(x,{login_data:this.state,onReq:function(t,n){return e.handleReq(t,n)}}),Object(v.jsx)(J,{middle_content:"login",onReq:function(t,n){return e.handleReq(t,n)}})]}),Object(v.jsxs)(j.d,{path:"/sign_up",children:[Object(v.jsx)(x,{login_data:this.state,onReq:function(t,n){return e.handleReq(t,n)}}),Object(v.jsx)(J,{middle_content:"sign_up",onReq:function(t,n){return e.handleReq(t,n)}})]}),Object(v.jsxs)(j.d,{path:"/dashboard",children:[Object(v.jsx)(x,{login_data:this.state,onReq:function(t,n){return e.handleReq(t,n)}}),Object(v.jsx)(J,{middle_content:"dashboard",login_data:this.state})]})]})})}}]),n}(a.Component);a.Component;r.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(o.BrowserRouter,{children:Object(v.jsx)(H,{})})}),document.getElementById("root"))},55:function(e,t){e.exports={BACKEND_ENDPOINT:"https://window-drop.azurewebsites.net/"}},67:function(e,t,n){},97:function(e,t,n){}},[[132,1,2]]]);
//# sourceMappingURL=main.3b50ef46.chunk.js.map